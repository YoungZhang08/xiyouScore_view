!function(){var e={init:function(){e.userPortrait(),e.infoDetail(),e.exitLogin()},userPortrait:function(){var e="http://scoreapi.xiyoumobile.com/users/img?username="+window.localStorage.username+"&session="+window.localStorage.session+"&name="+window.localStorage.name;document.querySelector(".img_header").querySelector("img").src=e,document.querySelector(".portrait").querySelector("img").src=e},infoDetail:function(){var e={userName:document.querySelector(".user_id"),userBirth:document.querySelector(".user_birth"),userAcademy:document.querySelector(".user_academy"),userClass:document.querySelector(".user_class"),userLevel:document.querySelector(".user_level"),userSex:document.querySelector(".user_sex"),userAge:document.querySelector(".user_age"),name:document.querySelector(".per_name").querySelector("span")};Ajax({url:"http://localhost:8000/users/info",method:"GET",dataType:"jsonp",data:{username:window.localStorage.username,session:window.localStorage.session,name:window.localStorage.name},success:function(t){e.name.innerHTML=t.result.name,e.userName.innerHTML=t.result.username,e.userBirth.innerHTML=t.result.birthday.substr(0,4)+"年"+t.result.birthday.substr(4,2)+"月"+t.result.birthday.substr(6,2)+"日",e.userAcademy.innerHTML=t.result.academy,e.userClass.innerHTML=t.result.class,e.userLevel.innerHTML=t.result.level+"级",e.userSex.innerHTML=t.result.sex,window.localStorage.level=t.result.level}})},exitLogin:function(){document.querySelector(".login_out").addEventListener("click",function(){window.localStorage.name="",window.localStorage.username="",window.localStorage.password="",window.localStorage.session="",window.location.href="../index.html"},!1)}};e.init()}(),function(){var e={init:function(){e.verCode(),e.verHandle(),e.subHandle()},verCode:function(){Ajax({url:"http://localhost:8000/users/verCode",method:"GET",dataType:"jsonp",success:function(e){document.querySelector(".verBtn").querySelector("img").setAttribute("src",e.result.verCode),window.localStorage.session=e.result.session}})},verHandle:function(){document.querySelector(".verBtn").addEventListener("click",function(){e.verCode()},!1)},submit:function(){var e={username:document.querySelector(".username").value,password:document.querySelector(".password").value,verCode:document.querySelector(".verCode").value};""==e.username||""==e.password?alert("用户信息不能为空!"):""==e.verCode&&alert("请填写验证码!"),Ajax({url:"http://localhost:8000/users/login",method:"POST",dataType:"jsonp",data:{username:e.username,password:e.password,verCode:e.verCode,session:window.localStorage.session},success:function(t){0==t.error?(alert("登录成功!"),window.localStorage.name=t.result,window.localStorage.username=e.username,window.localStorage.password=e.password,window.location.href="../html/main.html",e.verCode=""):alert("登录失败!")}})},subHandle:function(){document.querySelector(".login_btn").addEventListener("click",function(){e.submit()})}};e.init()}(),function(){var e={init:function(){e.notThrough(),e.fixMakeup()},notThrough:function(){Ajax({url:"http://localhost:8000/score/notThrough",method:"GET",dataType:"jsonp",data:{username:window.localStorage.username,session:window.localStorage.session,name:window.localStorage.name},success:function(t){e.fixNotThrough(t.result.length,t.result)}})},passed:function(){},fixNotThrough:function(e,t){var r=document.createDocumentFragment();console.log(r);for(var s=0;s<e;s++){var n=document.createElement("div");n.className="score_item",n.innerHTML='<div class="item_1"><div class="class_name">'+t[s].className+'</div><div class="class_nature"><img src=""></div></div><div class="item_2"><div class="credit">学分</div><div class="cre">'+t[s].credit+'</div><div class="heighest">最高成绩</div><div class="cre">'+t[s].highest+"</div></div></div>",console.log(n);var o=document.querySelector(".class_nature").querySelector("img");"必修课"==t[s].nature?o.setAttribute("src","../image/icon/scr_icon_must.png"):"选修课"==t[s].nature&&o.setAttribute("src","../image/icon/src_icon_slt.png")}document.querySelector(".notThr_show").appendChild(r)},fixMakeup:function(e,t){for(var r=document.createDocumentFragment(),s=0;s<e;s++){var n=document.createElement("div");n.className="score_item",n.innerHTML='<div class="item_1"><div class="class_name">'+t[s].className+'</div><div class="class_time">时间&nbsp;<span color="black">'+t[s].style+'</span></div></div><div class="item_2"><div class="seat_num">座位号&nbsp;<span color="black">'+t[s].seat+'</span></div><div class="class_room">考场&nbsp;<span color="black">'+t[s].room+"</span></div></div>"}document.querySelector(".makeup_show").appendChild(r)}};e.init()}();var shadowLayout=function(e){e.style.position="absolute",e.style.width="32%",e.style.height="100%",e.style.top="0",e.style.right="-32%",e.style.zIndex="-999"},ltor_click=function(e){e.protrait.addEventListener("click",function(){e.main_content.style.webkitTransform="translate3d(40%,0px,0px)",e.main_content.style.webkitTransition=".8s",e.shadow.style.zIndex="999",e.shadow.style.webkitTransform="translate3d(-100%,0px,0px)",e.shadow.style.webkitTransition=".8s",e.shadow.style.backgroundColor="rgba(0,0,0,.3)"},!1)},rtol_click=function(e){e.back.addEventListener("click",function(){e.main_content.style.webkitTransform="translate3d(0px,0px,0px)",e.main_content.style.webkitTransition=".8s",e.shadow.style.webkitTransform="translate3d(0px,0px,0px)",e.shadow.style.webkitTransition=".8s"},!1)};!function(){var e={main_content:document.querySelector(".main_content"),back:document.querySelector(".back"),container:document.querySelector(".container"),protrait:document.querySelector(".portrait"),shadow:document.createElement("div"),body:document.querySelector("body")};shadowLayout(e.shadow),e.body.appendChild(e.shadow),ltor_click(e),rtol_click(e)}(),function(){var e=document.getElementsByClassName("sel_opt"),t=[document.querySelector(".passed_show"),document.querySelector(".notThr_show"),document.querySelector(".makeup_show")];t[0].style.display="block",t[1].style.display="none",t[2].style.display="none",e[0].querySelector("img").setAttribute("src","../image/icon/scr_btn_pass_pre.png"),e[1].querySelector("img").setAttribute("src","../image/icon/scr_btn_upass_upre.png"),e[2].querySelector("img").setAttribute("src","../image/icon/scr_btn_inqu_upre.png"),e[0].addEventListener("click",function(){t[0].style.display="block",t[1].style.display="none",t[2].style.display="none",e[0].querySelector("img").setAttribute("src","../image/icon/scr_btn_pass_pre.png"),e[1].querySelector("img").setAttribute("src","../image/icon/scr_btn_upass_upre.png"),e[2].querySelector("img").setAttribute("src","../image/icon/scr_btn_inqu_upre.png")},!1),e[1].addEventListener("click",function(){t[0].style.display="none",t[1].style.display="block",t[2].style.display="none",e[0].querySelector("img").setAttribute("src","../image/icon/scr_btn_pass_upre.png"),e[1].querySelector("img").setAttribute("src","../image/icon/scr_btn_upass_pre.png"),e[2].querySelector("img").setAttribute("src","../image/icon/scr_btn_inqu_upre.png")},!1),e[2].addEventListener("click",function(){t[0].style.display="none",t[1].style.display="none",t[2].style.display="block",e[0].querySelector("img").setAttribute("src","../image/icon/scr_btn_pass_upre.png"),e[1].querySelector("img").setAttribute("src","../image/icon/scr_btn_upass_upre.png"),e[2].querySelector("img").setAttribute("src","../image/icon/scr_btn_inqu_pre.png")},!1)}();